# Generated file: !!! DO NOT EDIT !!!
---
env:
  PYPERFORMANCE_HASH: 16765924a3e845fe9c3c582b7576e5f1285955df
  PYSTON_BENCHMARKS_HASH: d9506cae863bb5c199ea71dce6a1733a12ba3ab8
name: _publish
on:
  workflow_call:
    inputs:
      dry_run:
        type: boolean
        default: false

  workflow_dispatch:
    inputs:
      dry_run:
        description: 'Dry run: Do not commit to the repo'
        type: boolean
        default: false

jobs:
  mirror:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout benchmarking
      uses: actions/checkout@v4
      with:
        path: private
        ref: main
        fetch-depth: 0
    - name: Checkout benchmarking-public
      uses: actions/checkout@v4
      with:
        path: public
        ref: main
        repository: ${{ github.repository }}
        token: ${{ secrets.BENCHMARK_TOKEN }}
    - name: Mirror
      run: |
        cd public
        git remote add upstream $PWD/../private
        git fetch upstream
        git reset --hard upstream/main
    - name: Push
      if: ${{ !inputs.dry_run }}
      run: |
        cd public
        git push origin main
